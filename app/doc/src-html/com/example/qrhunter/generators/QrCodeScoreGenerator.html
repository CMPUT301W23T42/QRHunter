<!DOCTYPE HTML>
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<main role="main">
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span><a id="line.1">package com.example.qrhunter.generators;</a>
<span class="sourceLineNo">002</span><a id="line.2"></a>
<span class="sourceLineNo">003</span><a id="line.3">/**</a>
<span class="sourceLineNo">004</span><a id="line.4"> * This class handles QRCode score generation</a>
<span class="sourceLineNo">005</span><a id="line.5"> */</a>
<span class="sourceLineNo">006</span><a id="line.6">public class QrCodeScoreGenerator {</a>
<span class="sourceLineNo">007</span><a id="line.7">    /***</a>
<span class="sourceLineNo">008</span><a id="line.8">     * Generates the score of a QRCode by counting repeated characters in a sha-256 hash</a>
<span class="sourceLineNo">009</span><a id="line.9">     * and adding the sums of the powers of the value of that hash</a>
<span class="sourceLineNo">010</span><a id="line.10">     * Example: hash = 25cce1b3f4ff0cee487dddddd029041014cf695b85daff02652fab7d308dc802</a>
<span class="sourceLineNo">011</span><a id="line.11">     * Repeats: c:2, f:2, e:2, d:6, f:2</a>
<span class="sourceLineNo">012</span><a id="line.12">     * Sum repeat values by power-1: 12^1+15^1+14^1+13^5+15^1 = 371349</a>
<span class="sourceLineNo">013</span><a id="line.13">     * @param hash: SHA-256. Generated by the contents of the qrcode within scanner</a>
<span class="sourceLineNo">014</span><a id="line.14">     * @return score</a>
<span class="sourceLineNo">015</span><a id="line.15">     */</a>
<span class="sourceLineNo">016</span><a id="line.16">    public int score_algorithm(String hash) {</a>
<span class="sourceLineNo">017</span><a id="line.17">        int score = 0;</a>
<span class="sourceLineNo">018</span><a id="line.18">        int i = 0;</a>
<span class="sourceLineNo">019</span><a id="line.19">        while (i &lt; hash.length()-1) {</a>
<span class="sourceLineNo">020</span><a id="line.20">            char fixedChar = hash.charAt(i);</a>
<span class="sourceLineNo">021</span><a id="line.21">            int j = 1; // Number of repeats of character</a>
<span class="sourceLineNo">022</span><a id="line.22">            while ( (i+j) &lt; hash.length() &amp;&amp; fixedChar == hash.charAt(i+j)) { // Next char = current char</a>
<span class="sourceLineNo">023</span><a id="line.23">                j ++;</a>
<span class="sourceLineNo">024</span><a id="line.24">            }</a>
<span class="sourceLineNo">025</span><a id="line.25">            if (j &gt; 1) { // Value repeats more than once</a>
<span class="sourceLineNo">026</span><a id="line.26">                int val;</a>
<span class="sourceLineNo">027</span><a id="line.27">                if (fixedChar != '0') {</a>
<span class="sourceLineNo">028</span><a id="line.28">                    val = Character.getNumericValue(fixedChar); // Gets value of non zero</a>
<span class="sourceLineNo">029</span><a id="line.29">                } else {</a>
<span class="sourceLineNo">030</span><a id="line.30">                    val = 20; // 0 Has special value of 20</a>
<span class="sourceLineNo">031</span><a id="line.31">                }</a>
<span class="sourceLineNo">032</span><a id="line.32">                if (j &lt; 5) { // Arbitrary number to prevent overflow</a>
<span class="sourceLineNo">033</span><a id="line.33">                    score += Math.pow(val, j-1);</a>
<span class="sourceLineNo">034</span><a id="line.34">                } else { // Prevents overflow. EG hash = "FFFFF ... FF" would have score 15^64.</a>
<span class="sourceLineNo">035</span><a id="line.35">                    score += Math.pow(val, 5);</a>
<span class="sourceLineNo">036</span><a id="line.36">                }</a>
<span class="sourceLineNo">037</span><a id="line.37">            }</a>
<span class="sourceLineNo">038</span><a id="line.38">            i += j;</a>
<span class="sourceLineNo">039</span><a id="line.39">        }</a>
<span class="sourceLineNo">040</span><a id="line.40">        return score;</a>
<span class="sourceLineNo">041</span><a id="line.41">    }</a>
<span class="sourceLineNo">042</span><a id="line.42">}</a>




























































</pre>
</div>
</main>
</body>
</html>
